<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Bingo Board</title>
  <link rel="icon" href="favicon.svg" type="image/svg+xml" />
  <link rel="stylesheet" href="css/styles.css" />
</head>

<body>

  <canvas id="bg"></canvas>
  <canvas id="fg"></canvas>
  <div class="vignette"></div>

  <div class="wrap">
    <div class="panel">
      <h1>Bingo Board</h1>
      <div class="subtitle">Make progress, one square at a time(ÔΩ°‚Ä¢ÃÄ·¥ó-)‚úß</div>

      <!-- START / SETUP -->
      <section id="screenStart" class="setup-section">
        <div class="hud">
          <div class="hud-left">
            <div class="stat"><span class="dot"></span> Bingos: <span id="statBingos">0</span></div>
            <div class="stat"><span class="dot" style="background:#ffce00"></span> Score: <span id="statScore">0</span></div>
            <button class="btn btn-ghost btn-small" id="btnViewSavedCard" style="padding:6px 10px; font-size:12px;">üìã View saved card</button>
          </div>
          <div class="hud-right buttons">
            <button class="btn btn-ghost btn-sound" id="btnSound">Sound: On</button>
            <button class="btn btn-ghost" id="btnBackgroundMusic">Background music</button>
            <button class="btn btn-ghost" id="btnHelp" title="How to play" aria-label="How to play">?</button>
          </div>
        </div>

        <!-- Goal pool first (essential for gameplay) -->
        <div class="setup-card setup-card-goal-pool">
          <div class="goal-pool-header">
            <label>Goal pool</label>
            <span id="goalsHint" class="helper-text helper-warn hidden">Add goals to start.</span>
          </div>
          <div class="goal-pool-actions">
            <div class="goal-pool-left">
              <button id="btnFillSample" class="btn btn-ghost btn-small">Use sample</button>
              <button id="btnLoadPool" class="btn btn-ghost btn-small">Load pool</button>
            </div>
            <div class="goal-pool-right">
              <button id="btnSavePool" class="btn btn-ghost btn-small">Save pool</button>
              <button id="btnClearGoals" class="btn btn-destructive btn-small">Clear</button>
            </div>
          </div>
          <textarea id="goalsInput" class="field goals-textarea" placeholder="Enter your goals, one per line..."></textarea>
          <div class="goal-pool-footer">
            <span id="goalsCounter" class="helper-text">Goals: 0/0</span>
            <button id="btnGenerate" class="btn btn-outline">Generate</button>
          </div>
        </div>

        <hr class="setup-divider" aria-hidden="true" />

        <!-- Compact settings row -->
        <div class="setup-grid setup-grid-compact">
          <div class="setup-card setup-card-compact">
            <label>Board size</label>
            <select id="sizeSelect" class="field field-compact">
              <option value="3">3 √ó 3</option>
              <option value="4">4 √ó 4</option>
              <option value="5" selected>5 √ó 5</option>
            </select>
            <div class="helper-text">Center "Free" space (odd sizes).</div>
          </div>
          <div class="setup-card setup-card-compact">
            <label>Win condition</label>
            <select id="winSelect" class="field field-compact">
              <option value="1" selected>1 Bingo</option>
              <option value="2">2 Bingos</option>
              <option value="3">3 Bingos</option>
              <option value="5">5 Bingos</option>
              <option value="blackout">Blackout (all marked)</option>
            </select>
            <label class="checkbox-row checkbox-row-free">
              <input id="freeToggle" type="checkbox" checked />
              <span>Center "Free" space</span>
            </label>
          </div>
        </div>

        <hr class="setup-divider" aria-hidden="true" />

        <!-- Your Bingo Board Preview -->
        <div class="setup-card setup-card-preview">
          <div class="preview-header">
            <label class="preview-title">Your Bingo Board Preview (<span id="previewCount">0</span> tiles)</label>
            <label class="preview-toggle-chip" for="previewShowGoals">
              <input type="checkbox" id="previewShowGoals" checked aria-label="Show goal text in preview" />
              <span class="preview-toggle-label">Show goals</span>
            </label>
          </div>
          <div id="previewEmpty" class="preview-empty hidden">No goals yet ‚Äî add some above!</div>
          <div id="previewGrid" class="preview-grid" style="grid-template-columns: repeat(5, 1fr);"></div>
          <div class="preview-actions">
            <button id="btnStart" class="btn btn-primary btn-start">Start</button>
            <button id="btnImport" class="btn btn-ghost btn-small">üì• Import</button>
            <button id="btnExport" class="btn btn-ghost btn-small">üì§ Export</button>
            <button id="btnCopyShare" class="btn btn-ghost btn-small">Share link</button>
          </div>
        </div>
      </section>

      <!-- GAMEPLAY -->
      <section id="screenPlay" class="hidden">
        <div class="hud">
          <div class="hud-left">
            <div class="stat"><span class="dot"></span> Marked: <span id="statMarked">0</span>/<span
                id="statTotal">25</span></div>
            <div class="stat"><span class="dot"></span> Bingos: <span id="statBingosPlay">0</span></div>
            <div class="stat"><span class="dot" style="background:#ffce00"></span> Score: <span
                id="statScorePlay">0</span></div>
            <div class="stat"><span class="dot" style="background:#2ecc71"></span> Best: <span id="statBest">0</span>
            </div>
            <div class="stat"><span class="dot" style="background:#3498db"></span> Time: <span id="statTime">0:00</span>
            </div>
            <div class="stat"><span class="dot" style="background:#ff6b6b"></span> Strikes: <span id="statStrikes">3</span></div>
          </div>
          <div class="hud-right buttons">
            <button id="btnEndGame" class="btn secondary hidden" title="You already won ‚Äî show game over again">End game</button>
            <button id="btnPauseTime" class="btn ghost">‚è∏ Pause</button>
            <button id="btnResetMarks" class="btn secondary">Reset</button>
            <button id="btnBackToSetup" class="btn ghost">Exit</button>
          </div>
        </div>

        <div id="pauseBanner" class="pause-banner hidden" role="status" aria-live="polite">
          Game paused ‚Äî tap Resume to continue
        </div>

        <div id="board" class="board"></div>

        <div class="status" id="status">
          <div style="font-size:12px; color:#666;">
            üéØ Win goal: <b id="winGoalLabel" style="color:#222;">1 Bingo</b> ¬∑ Long-press a tile for options.
          </div>
        </div>
      </section>

      <!-- GAME OVER -->
      <section id="screenOver" class="hidden">
        <div class="victory-card">
          <!-- Decorative rays -->
          <div class="victory-rays" aria-hidden="true">
            <div class="victory-ray" style="transform: rotate(0deg);"></div>
            <div class="victory-ray" style="transform: rotate(45deg);"></div>
            <div class="victory-ray" style="transform: rotate(90deg);"></div>
            <div class="victory-ray" style="transform: rotate(135deg);"></div>
            <div class="victory-ray" style="transform: rotate(180deg);"></div>
            <div class="victory-ray" style="transform: rotate(225deg);"></div>
            <div class="victory-ray" style="transform: rotate(270deg);"></div>
            <div class="victory-ray" style="transform: rotate(315deg);"></div>
          </div>

          <!-- Sparkles -->
          <div class="victory-sparkle s1" aria-hidden="true">‚ú®</div>
          <div class="victory-sparkle s2" aria-hidden="true">‚≠ê</div>
          <div class="victory-sparkle s3" aria-hidden="true">üí´</div>
          <div class="victory-sparkle s4" aria-hidden="true">‚ú®</div>

          <div class="victory-inner">
            <!-- Coins -->
            <div class="victory-coins" aria-hidden="true">
              <div class="victory-coin"></div>
              <div class="victory-coin"></div>
              <div class="victory-coin"></div>
            </div>

            <!-- Party popper and Title -->
            <div class="victory-header">
              <div class="victory-popper" aria-hidden="true">üéâ</div>
              <div class="victory-title" id="overTitle">BINGO!</div>
              <div class="victory-subtitle" id="overSubtitle">You hit your win condition.</div>
            </div>

            <!-- Stats -->
            <div class="victory-stats" role="group" aria-label="Game summary">
              <div class="victory-stat">
                <div class="victory-stat-value" id="overScoreVal">0</div>
                <div class="victory-stat-label">Score</div>
              </div>
              <div class="victory-stat">
                <div class="victory-stat-value" id="overBingosVal">0</div>
                <div class="victory-stat-label" id="overBingosLabel">Bingos</div>
              </div>
              <div class="victory-stat">
                <div class="victory-stat-value" id="overTimeVal">0:00</div>
                <div class="victory-stat-label">Time</div>
              </div>
            </div>

            <!-- Actions -->
            <div class="victory-actions">
              <button class="btn victory-primary" id="btnKeepPlaying">Keep Playing</button>
              <div class="victory-actions-row">
                <button id="btnSaveCardImage" class="btn secondary">Download Card</button>
                <button id="btnSaveCardOver" class="btn secondary">Save Card</button>
                <button class="btn secondary" id="btnNewRound">New Board</button>
              </div>
              <button class="btn ghost" id="btnOverSetup">Back to Setup</button>
            </div>
          </div>
        </div>
      </section>
      <footer class="app-footer">Developed with ‚ô• by <a href="https://github.com/jaymie-b-ecoben" target="_blank" rel="noopener noreferrer">Jaymie</a></footer>
    </div>
  </div>

  <!-- MODALS -->
  <div id="modalHost" class="hidden"></div>

  <!-- Music Player -->
  <div id="musicPlayer" class="music-player collapsed">
    <div class="music-header">
      <div class="music-title"><span id="musicTitleIcon">üéµ</span><span id="musicTitleText"> Cozy Tunes</span></div>
      <button class="music-toggle" id="musicToggle">‚ñº</button>
    </div>
    <div class="music-content">
      <!-- Expanded view -->
      <div class="music-now-playing">
        <div class="music-artwork" id="musicArtwork">üéµ</div>
        <div class="music-info">
          <div class="music-song-name" id="musicSongName">Select a song</div>
          <div class="music-artist" id="musicArtist">‚Äî</div>
        </div>
        <div class="music-controls">
          <button class="music-btn" id="musicPrev">‚èÆ</button>
          <button class="music-btn play" id="musicPlay">‚ñ∂</button>
          <button class="music-btn" id="musicNext">‚è≠</button>
          <button class="music-btn music-btn-text" id="musicLoop" title="Loop current song">LOOP</button>
        </div>
      </div>
      <div class="music-progress-wrap">
        <div class="music-progress">
          <div class="music-progress-bar" id="musicProgress"></div>
        </div>
        <div class="music-time" id="musicTime" aria-live="polite">0:00 / 0:00</div>
      </div>
      <div class="music-add-section">
        <div style="font-weight:900; font-size:12px; margin-bottom:6px;">Add Music</div>
        <div class="music-add-buttons">
          <button class="music-add-btn upload" id="musicUploadBtn">Upload MP3</button>
          <button class="music-add-btn youtube" id="musicYoutubeBtn">YouTube</button>
        </div>
        <input type="file" id="musicFileInput" class="music-file-input" accept="audio/*,.mp3" />
      </div>
      <div class="music-playlist" id="musicPlaylist">
        <!-- Songs will be added here -->
      </div>
    </div>
  </div>

  <script src="js/background.js"></script>
  <script src="js/game.js"></script>
  <script src="js/music-player.js"></script>
</body>

</html>